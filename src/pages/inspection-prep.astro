---
import DashboardLayout from "../layouts/DashboardLayout.astro";
import ChecklistItem from "../components/ChecklistItem.astro";
import Lightbox from "../components/Lightbox.astro";
import Icon from "../components/Icon.astro";
import { getCollection } from "astro:content";

const items = await getCollection("inspection_prep");
const sortedItems = items.sort((a, b) => a.data.order - b.data.order);
---

<DashboardLayout title="ì •ê¸°ê²€ì‚¬ ìˆ˜ê²€ì¤€ë¹„" scale={0.85}>
	<style>
		/* main width is defined in global.css */
		.intro {
			margin-bottom: 1.5rem; /* Reduced margin */
			background-color: var(--bg-card);
			padding: 0.75rem 1rem; /* Compact padding */
			border-radius: 8px;
			border: 1px solid var(--border-color);
			color: var(--text-main);
			font-size: 0.85rem;
			display: flex;
			align-items: center;
			justify-content: space-between;
			gap: 1rem;
		}
		.intro p {
			margin: 0;
			line-height: 1.4;
		}
		.reset-btn {
			background-color: #475569; /* Slate 600 - Neutral/Professional */
			color: white;
			border: none;
			padding: 0.4rem 0.8rem; /* Smaller padding */
			border-radius: 6px;
			cursor: pointer;
			font-size: 0.8rem;
			white-space: nowrap;
			flex-shrink: 0;
			transition: background-color 0.2s;
		}
		.reset-btn:hover {
			background-color: #334155;
		}
		.download-section {
			margin-top: 3rem;
			text-align: center;
			border-top: 1px solid var(--border-color);
			padding-top: 2rem;
		}
		.download-link {
			display: inline-flex;
			align-items: center;
			margin-top: 1rem;
			padding: 0.75rem 1.25rem;
			background-color: var(--bg-card);
			border: 1px solid var(--border-color);
			color: var(--text-main);
			text-decoration: none;
			border-radius: 8px;
			transition: background-color 0.2s;
			font-size: 0.9rem;
			gap: 0.5rem;
		}
		.download-link:hover {
			background-color: var(--bg-sidebar);
			border-color: var(--accent);
		}
		.download-link.secondary {
			background-color: transparent;
			border-style: dashed;
			color: var(--text-muted);
		}
		.accent-text {
			color: #ef4444; /* Red accent for warnings/notes */
		.section-container {
			margin-bottom: 2.5rem;
		}
		.section-title {
			font-size: 1rem;
			color: var(--text-main);
			margin-top: 1.25rem;
			margin-bottom: 0.5rem;
			border-left: 3px solid var(--accent);
			padding-left: 0.6rem;
			font-weight: 700;
		}
		.info-card {
			background-color: var(--bg-card);
			border: 1px solid var(--border-color);
			border-radius: 8px;
			padding: 1.25rem;
			box-shadow: 0 1px 2px var(--shadow-color);
		}
		.info-title {
			font-size: 1rem;
			font-weight: 700;
			color: var(--accent);
			margin-bottom: 0.5rem;
			display: flex;
			align-items: center;
			gap: 0.5rem;
		}
		.info-desc {
			font-size: 0.95rem;
			line-height: 1.5;
			color: var(--text-main);
			margin: 0;
		}
		.accent-text {
			color: #ef4444; /* Red accent for warnings/notes */
			font-size: 0.9rem;
			font-weight: 500;
		}
		.mb-4 {
			margin-bottom: 1rem;
		}
	</style>

	<div
		style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;"
	>
		<h1
			style="font-size: 1rem; margin: 0; display: flex; align-items: center; gap: 0.4rem; line-height: 1.3;"
		>
			<Icon name="check-square" size="18" class="inline-icon" /> ì •ê¸°ê²€ì‚¬ ìˆ˜ê²€ì¤€ë¹„ ì²´í¬ë¦¬ìŠ¤íŠ¸
		</h1>
		<button id="resetBtn" class="reset-btn">ì„ íƒí•´ì œ</button>
	</div>

	<p
		style="font-size: 0.9rem; color: #6b7280; margin-top: -0.5rem; margin-bottom: 1.5rem; line-height: 1.5;"
	>
		ğŸ’¡ ì²´í¬ë°•ìŠ¤ì˜ ìƒíƒœëŠ” ìë™ì €ì¥ì´ ë˜ë©°, í•­ëª©ì„ í´ë¦­í•˜ì‹œë©´ í•˜ìœ„í•­ëª©ì´
		ë³´ì…ë‹ˆë‹¤.<br />
		ì‘ì„±ì§€ì¹¨ê³¼ ì‘ì„±ì˜ˆì‹œë¥¼ í´ë¦­í•˜ë©´ PDF íŒŒì¼ì´ ì—´ë¦½ë‹ˆë‹¤.<br />
		ë²•ë ¹Â·ê·œì¹™Â·ê³ ì‹œëŠ” êµ­ê°€ë²•ë ¹ì •ë³´ì„¼í„°ë¥¼ ì§ì ‘ ë§í¬í•˜ì˜€ìŠµë‹ˆë‹¤.
	</p>


	<!-- Section 1: Cooperation Request -->
	<div class="section-container">
		<!-- Title removed from here as it becomes the accordion title? No, User said "1. ìˆ˜ê²€í˜‘ì¡°ì‚¬í•­" is the item title? 
             User said: "ìˆ˜ê²€í˜‘ì¡°ì‚¬í•­(cooperation)ì—ì„œ ë²ˆí˜¸ê°€ ì•„ë‹ˆë¼ ì²´í¬ë°•ìŠ¤ê°€ í•„ìš”í•˜ë‹¤" 
             This usually means the Header itself has the checkbox (which ChecklistItem has).
             "1ë‹¨ê³„ëŠ” í•„ì³ì € ë³´ì´ë„ë¡ í•œë‹¤" -> Default Open.
             
             Let's use "ìˆ˜ê²€í˜‘ì¡°ì‚¬í•­ (Cooperation)" as the Category or Title.
             Let's use a Generic Title or Empty?
             
             User Spec:
             Level 1: Accordion (Open)
             Content:
               [ ] ê²€ì‚¬ì›...ê³µê°„
               [ ] ë…¸íŠ¸ë¶...ê°€ëŠ¥
               [ ] ìˆ˜ê²€ ë§¤ë‰´ì–¼...ë¹„ì¹˜
               [ ] ì „ì‚°ìë£Œ...ì¤€ë¹„
        -->
		<h2 class="section-title">1. ìˆ˜ê²€í˜‘ì¡° ìš”ì²­ì‚¬í•­</h2>

		<div class="checklist-container" id="cooperationContainer">
			{
				[
					{
						id: "coop-merged",
						slug: "coop-merged",
						data: {
							order: 1,
							title: "ìˆ˜ê²€ ì¥ì†Œì™€ ìë£Œ ì¤€ë¹„",
							category: "",
							content: `
                                <ul style="padding-left: 0.5rem; margin: 0;">
                                    <li style="list-style: none; margin-bottom: 0.5rem;">
                                        <label style="display: flex; align-items: flex-start; gap: 0.5rem; cursor: pointer;">
                                            <input type="checkbox" /> 
                                            <span style="line-height: 1.5;">ê²€ì‚¬ì› ë° ìˆ˜ê²€ìê°€ í™œìš©í•  ìˆ˜ ìˆëŠ” íšŒì˜í…Œì´ë¸”ì´ ë§ˆë ¨ëœ ë³„ë„ ê³µê°„</span>
                                        </label>
                                    </li>
                                    <li style="list-style: none; margin-bottom: 0.5rem;">
                                        <label style="display: flex; align-items: flex-start; gap: 0.5rem; cursor: pointer;">
                                            <input type="checkbox" /> 
                                            <span style="line-height: 1.5;">ë…¸íŠ¸ë¶ ì‚¬ìš©(ì „ì›)ì´ ê°€ëŠ¥í•œ ê³µê°„</span>
                                        </label>
                                    </li>
                                    <li style="list-style: none; margin-bottom: 0.5rem;">
                                        <label style="display: flex; align-items: flex-start; gap: 0.5rem; cursor: pointer;">
                                            <input type="checkbox" /> 
                                            <span style="line-height: 1.5;">ìˆ˜ê²€ ë§¤ë‰´ì–¼ì— ì œì‹œëœ ìˆ˜ê²€ì— í•„ìš”í•œ ê°ì¢… ì„œë¥˜ë¥¼ ìˆ˜ê²€ì¥ì†Œì— ë¹„ì¹˜</span>
                                        </label>
                                    </li>
                                    <li style="list-style: none; margin-bottom: 0.5rem;">
                                        <label style="display: flex; align-items: flex-start; gap: 0.5rem; cursor: pointer;">
                                            <input type="checkbox" /> 
                                            <span style="line-height: 1.5;">ì „ì‚°ìë£Œì˜ ê²½ìš° ì§ì ‘ í™•ì¸ ê°€ëŠ¥í•œ PC ì¤€ë¹„</span>
                                        </label>
                                    </li>
                                </ul>
                            `,
							check: [
								"íšŒì˜í…Œì´ë¸” ê³µê°„",
								"ë…¸íŠ¸ë¶ ì „ì›",
								"ì„œë¥˜ ë¹„ì¹˜",
								"í™•ì¸ìš© PC",
							],
						},
					},
				].map((item) => <ChecklistItem item={item} open={false} />)
			}
		</div>
	</div>

	<!-- Section 2: Common Preparation -->
	<div class="section-container">
		<h2 class="section-title">2. ê³µí†µ ì¤€ë¹„ì‚¬í•­</h2>

		<div class="checklist-container" id="checklistContainer">
			{
				sortedItems
					.filter(
						(item) =>
							item.data.category !== "ì˜ë£Œë¶„ì•¼" &&
							item.data.category !== "íŒë§¤ë¶„ì•¼" &&
							item.data.category !== "ìƒì‚°ë¶„ì•¼",
					)
					.map((item) => <ChecklistItem item={item} />)
			}
		</div>
	</div>

	<!-- Section 3: Medical Field -->
	<div class="section-container">
		<h2 class="section-title">3. ì˜ë£Œë¶„ì•¼ ì¤€ë¹„ìë£Œ</h2>
		<div class="checklist-container">
			{
				sortedItems
					.filter((item) => item.data.category === "ì˜ë£Œë¶„ì•¼")
					.map((item) => <ChecklistItem item={item} />)
			}
		</div>
	</div>

	<!-- Section 4: Sales Field -->
	<div class="section-container">
		<h2 class="section-title">4. íŒë§¤ë¶„ì•¼ ì¤€ë¹„ì„œë¥˜</h2>
		<div class="checklist-container">
			{
				sortedItems
					.filter((item) => item.data.category === "íŒë§¤ë¶„ì•¼")
					.map((item) => <ChecklistItem item={item} />)
			}
		</div>
	</div>

	<!-- Section 5: Production Field -->
	<div class="section-container">
		<h2 class="section-title">5. ìƒì‚°ë¶„ì•¼ ì¤€ë¹„ìë£Œ</h2>
		<div class="checklist-container">
			{
				sortedItems
					.filter((item) => item.data.category === "ìƒì‚°ë¶„ì•¼")
					.map((item) => <ChecklistItem item={item} />)
			}
		</div>
	</div>


	<div class="download-section">
		<p>ì „ì²´ ë‚´ìš©ì„ ì›ë³¸ìœ¼ë¡œ í™•ì¸í•˜ì‹œë ¤ë©´ PDFë¥¼ ë‹¤ìš´ë¡œë“œí•˜ì„¸ìš”.</p>
		<div
			class="button-group"
			style="display:flex; justify-content:center; gap:0.5rem; flex-wrap:wrap;"
		>
			<a
				href="/archive/ë°©ì‚¬ì„ ë¶„ì•¼ ì •ê¸°ê²€ì‚¬ìˆ˜ê²€ê°€ì´ë“œ(2022ë…„ ê°œì •)_ìµœì¢…ë³¸.pdf"
				class="download-link"
				target="_blank"
			>
				ğŸ‘ï¸ ì›ë³¸ ê°€ì´ë“œ ë³´ê¸° (PDF)
			</a>
			<a
				href="/archive/ë°©ì‚¬ì„ ë¶„ì•¼ ì •ê¸°ê²€ì‚¬ìˆ˜ê²€ê°€ì´ë“œ(2022ë…„ ê°œì •)_ìµœì¢…ë³¸.pdf"
				class="download-link secondary"
				download
			>
				ğŸ’¾ ë‹¤ìš´ë¡œë“œ
			</a>
		</div>
	</div>

	<Lightbox />

	<script>
		// GLOBAL DELEGATION REMOVED TO PREVENT CONFLICT
		// Original logic restored in ChecklistItem.astro
	</script>
</DashboardLayout>
